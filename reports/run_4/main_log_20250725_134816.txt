Log de execução será salvo em: c:\Projects\factored-medical-qa-bot\reports\run_4\main_log_20250725_134816.txt

==================================================================================================== 
DOWNLOADING DATA
====================================================================================================
Dataset already exists at c:\Projects\factored-medical-qa-bot\data\intern_screening_dataset.csv
==================================================================================================== 
PREPARING VECTOR DATABASE
====================================================================================================
Loading Sentence Transformer model: 'sentence-transformers/all-MiniLM-L6-v2'...
Generating embeddings for 20260 chunks... This may take a few minutes.
Embeddings generated in 40.20 seconds.
Creating FAISS index with dimension 384...
Adding vectors to the FAISS index...
The index now contains 20260 vectors.
Saving FAISS index to 'c:\Projects\factored-medical-qa-bot\models\run_4\faiss_index.bin'...
Saving metadata (chunks) to 'c:\Projects\factored-medical-qa-bot\models\run_4\chunks_metadata.pkl'...

Process completed successfully!
Index saved at: c:\Projects\factored-medical-qa-bot\models\run_4\faiss_index.bin
Metadata saved at: c:\Projects\factored-medical-qa-bot\models\run_4\chunks_metadata.pkl
==================================================================================================== 
PREPARING TRAINING DATA
====================================================================================================
Loading FAISS index, metadata, and embedding model for context augmentation...
FAISS index with 20260 vectors, and metadata for 20260 chunks loaded.
Generating SQuAD-style data with augmented context...

--- Example of Generated Training Data ---
{
  "id": "5095849535192856344",
  "title": "Medical Information",
  "context": "certain traits, conditions, or habits may raise your risk forcoronary heart disease ( chd ). these conditions are known as risk factors. risk factors also increase the chance that existing chd will worsen. women generally have the same chd risk factors as men. however, some risk factors may affect women differently than men. for example, diabetes raises the risk of chd more in women. also, some risk factors, such as birth control pills and menopause, only affect women. there are many known chd risk factors. your risk for chd andheart attackrises with the number of risk factors you have and their severity. risk factors tend to \" gang up \" and worsen each other ' s effects. having just one risk factor doubles your risk for chd. having two risk factors increases your risk for chd fourfold. having three or more risk factors increases your risk for chd more than tenfold. also, some risk factors, such as smoking and diabetes, put you at greater risk for chd and heart attack than others. more than 75 percent of women aged 40 to 60 have one or more risk factors for chd. many risk factors start during childhood ; some even develop within the first 10 years of life. you can control most risk factors, but some you can ' t. for more information about chd risk factors, go to the health topics coronary heart disease risk factorsarticle. to find out whether you ' re at risk for chd, talk with your doctor or health care provider. risk factors you can control smoking smoking is the most powerful risk factor that women can control. smoking tobacco or long - term exposure to secondhand smoke raises your risk for chd and heart attack. smoking exposes you to carbon monoxide. this chemical robs your blood of oxygen and triggers a buildup of plaque in your arteries. smoking also increases the risk of blood clots forming in your arteries.\n\nHigh Blood Cholesterol and Triglyceride Levels\n                \nCholesterol\n                \nHigh blood cholesterol is a condition in which your blood has too much cholesterola waxy, fat-like substance. The higher your blood cholesterol level, the greater your risk of coronary heart disease (CHD) and heart attack.\n                \nCholesterol travels through the bloodstream in small packages called lipoproteins. Two major kinds of lipoproteins carry cholesterol throughout your body:\n                \nLow-density lipoproteins (LDL). LDL cholesterol sometimes is called \"bad\" cholesterol. This is because it carries cholesterol to tissues, including your heart arteries. A high LDL cholesterol level raises your risk of CHD.\n                \nHigh-density lipoproteins (HDL). HDL cholesterol sometimes is called \"good\" cholesterol. This is because it helps remove cholesterol from your arteries. A low HDL cholesterol level raises your risk of CHD.\n                \nMany factors affect your cholesterol levels. For example, after menopause, women's LDL cholesterol levels tend to rise, and their HDL cholesterol levels tend to fall. Other factorssuch as age, gender, diet, and physical activityalso affect your cholesterol levels.\n                \nHealthy levels of both LDL and HDL cholesterol will prevent plaque from building up in your arteries. Routine blood tests can show whether your blood cholesterol levels are healthy. Talk with your doctor about having your cholesterol tested and what the results mean.\n                \nChildren also can have unhealthy cholesterol levels, especially if they're overweight or their parents have high blood cholesterol. Talk with your child's doctor about testing your child' cholesterol levels.\n                \nTo learn more about high blood cholesterol and how to manage the condition, go to the Health Topics High Blood Cholesterol article.\n                \nTriglycerides\n                \nTriglycerides are a type of fat found in the blood. Some studies suggest that a high level of triglycerides in the blood may raise the risk of CHD, especially in women.\n                \nHigh Blood Pressure\n                \n\"Blood pressure\" is the force of blood pushing against the walls of your arteries as your heart pumps blood. If this pressure rises and stays high over time, it can damage your heart and lead to plaque buildup.All levels above 120/80 mmHg raise your risk of CHD. This risk grows as blood pressure levels rise. Only one of the two blood pressure numbers has to be above normal to put you at greater risk of CHD and heart attack.\n                \n\n                \nMost adults should have their blood pressure checked at least once a year. If you have high blood pressure, you'll likely need to be checked more often. Talk with your doctor about how often you should have your blood pressure checked.\n                \nChildren also can develop high blood pressure, especially if they're overweight. Your child's doctor should check your child's blood pressure at each routine checkup.\n                \nBoth children and adults are more likely to develop high blood pressure if they're overweight or have diabetes.\n                \nFor more information about high blood pressure and how to manage the condition, go to the Health Topics High Blood Pressure article.\n                \nDiabetes and Prediabetes\n                \nDiabetes is a disease in which the body's blood sugar level is too high. The two types of diabetes are type 1 and type 2.\n                \nIn type 1 diabetes, the body's blood sugar level is high because the body doesn't make enough insulin. Insulin is a hormone that helps move blood sugar into cells, where it's used for energy. In type 2 diabetes, the body's blood sugar level is high mainly because the body doesn't use its insulin properly.\n                \nOver time, a high blood sugar level can lead to increased plaque buildup in your arteries. Having diabetes doubles your risk of CHD.\n                \nPrediabetes is a condition in which your blood sugar level is higher than normal, but not as high as it is in diabetes. If you have prediabetes and don't take steps to manage it, you'll likely develop type 2 diabetes within 10 years. You're also at higher risk of CHD.\n                \nBeing overweight or obese raises your risk of type 2 diabetes. With modest weight loss and moderate physical activity, people who have prediabetes may be able to delay or prevent type 2 diabetes. They also may be able to lower their risk of CHD and heart attack. Weight loss and physical activity also can help control diabetes.\n                \nEven children can develop type 2 diabetes. Most children who have type 2 diabetes are overweight.\n                \nType 2 diabetes develops over time and sometimes has no symptoms. Go to your doctor or local clinic to have your blood sugar levels tested regularly to check for diabetes and prediabetes.\n                \nFor more information about diabetes and heart disease, go to the Health Topics Diabetic Heart Disease article. For more information about diabetes and prediabetes, go to the National Institute of Diabetes and Digestive and Kidney Diseases' (NIDDK's) Introduction to Diabetes.\n                \nOverweight and Obesity\n                \nThe terms \"overweight\" and \"obesity\" refer to body weight that's greater than what is considered healthy for a certain height. More than two-thirds of American adults are overweight, and almost one-third of these adults are obese.\n                \nThe most useful measure of overweight and obesity is body mass index (BMI).You can use the National Heart, Lung, and Blood Institute's (NHLBI's) online BMI calculator to figure out your BMI, or your doctor can help you.\n                \nOverweight is defined differently for children and teens than it is for adults. Children are still growing, and boys and girls mature at different rates. Thus, BMIs for children and teens compare their heights and weights against growth charts that take age and gender into account. This is called BMI-for-age percentile.\n                \nBeing overweight or obese can raise your risk of CHD and heart attack. This is mainly because overweight and obesity are linked to other CHD risk factors, such as high blood cholesterol and triglyceride levels, high blood pressure, and diabetes.\n                \nFor more information, go to the Health Topics Overweight and Obesity article.\n                \nSmoking\n                \nSmoking tobacco or long-term exposure to secondhand smoke raises your risk of CHD and heart attack.\n                \nSmoking triggers a buildup of plaque in your arteries. Smoking also increases the risk of blood clots forming in your arteries. Blood clots can block plaque-narrowed arteries and cause a heart attack.Some research shows that smoking raises your risk of CHD in part by lowering HDL cholesterol levels.\n                \nThe more you smoke, the greater your risk of heart attack. The benefits of quitting smoking occur no matter how long or how much you've smoked. Heart disease risk associated with smoking begins to decrease soon after you quit, and for many people it continues to decrease over time.\n                \nMost people who smoke start when they're teens. Parents can help prevent their children from smoking by not smoking themselves. Talk with your child about the health dangers of smoking and ways to overcome peer pressure to smoke.\n                \nFor more information, including tips on how to quit smoking, go to the Health Topics Smoking and Your Heart article and the NHLBI's \"Your Guide to a Healthy Heart.\"\n                \nFor more information about children and smoking, go to the U.S. Department of Health and Human Services' (HHS') Kids and Smoking Web page and the CDC's Smoking and Tobacco Use Web page.\n                \nLack of Physical Activity\n                \nInactive people are nearly twice as likely to develop CHD as those who are active. A lack of physical activity can worsen other CHD risk factors, such as high blood cholesterol and triglyceride levels, high blood pressure, diabetes and prediabetes, and overweight and obesity.\n                \nIt's important for children and adults to make physical activity part of their daily routines. One reason many Americans aren't active enough is because of hours spent in front of TVs and computers doing work, schoolwork, and leisure activities.\n                \nSome experts advise that children and teens should reduce screen time because it limits time for physical activity. They recommend that children aged 2 and older should spend no more than 2 hours a day watching TV or using a computer (except for school work).\n                \nBeing physically active is one of the most important things you can do to keep your heart healthy. The good news is that even modest amounts of physical activity are good for your health. The more active you are, the more you will benefit.\n                \nFor more information, go to HHS' \"2008 Physical Activity Guidelines for Americans,\" the Health Topics Physical Activity and Your Heart article, and the NHLBI's \"Your Guide to Physical Activity and Your Heart.\"\n                \nUnhealthy Diet\n                \nAn unhealthy diet can raise your risk of CHD. For example, foods that are high in saturated and trans fats and cholesterol raise LDL cholesterol. Thus, you should try to limit these foods.\n                \nIt's also important to limit foods that are high in sodium (salt) and added sugars. A high-salt diet can raise your risk of high blood pressure.\n                \nAdded sugars will give you extra calories without nutrients like vitamins and minerals. This can cause you to gain weight, which raises your risk of CHD. Added sugars are found in many desserts, canned fruits packed in syrup, fruit drinks, and nondiet sodas.\n                \nStress\n                \nStress and anxiety may play a role in causing CHD. Stress and anxiety also can trigger your arteries to tighten. This can raise your blood pressure and your risk of heart attack.\n                \nThe most commonly reported trigger for a heart attack is an emotionally upsetting event, especially one involving anger. Stress also may indirectly raise your risk of CHD if it makes you more likely to smoke or overeat foods high in fat and sugar.\n                \nAge\n                \nIn men, the risk for coronary heart disease (CHD) increases starting around age 45. In women, the risk for CHD increases starting around age 55. Most people have some plaque buildup in their heart arteries by the time theyre in their 70s. However, only about 25 percent of those people have chest pain, heart attacks, or other signs of CHD.\n                \nGender\n                \nSome risk factors may affect CHD risk differently in women than in men. For example, estrogen provides women some protection against CHD, whereas diabetes raises the risk of CHD more in women than in men.\n                \nAlso, some risk factors for heart disease only affect women, such as preeclampsia, a condition that can develop during pregnancy. Preeclampsia is linked to an increased lifetime risk of heart disease, including CHD, heart attack, heart failure, and high blood pressure. (Likewise, having heart disease risk factors, such as diabetes or obesity, increases a womans risk of preeclampsia.)\n                \nFamily History\n                \nA family history of early CHD is a risk factor for developing CHD, specifically if a father or brother is diagnosed before age 55, or a mother or sister is diagnosed before age 65.\n\nangina is a symptom of an underlying heart problem. its usually a symptom of coronary heart disease ( chd ), but it also can be a symptom of coronary microvascular disease ( mvd ). so, if youre at risk for chd or coronary mvd, youre also at risk for angina. the major risk factors for chd and coronary mvd include : unhealthy cholesterol levels. high blood pressure. smoking. insulin resistance or diabetes. overweight or obesity. metabolic syndrome. lack of physical activity. unhealthy diet. older age. ( the risk increases for men after 45 years of age and for women after 55 years of age. ) family history of early heart disease. for more detailed information about chd and coronary mvd risk factors, visit the diseases and conditions index coronary heart disease, coronary heart disease risk factors, and coronary microvascular disease articles. people sometimes think that because men have more heart attacks than women, men also suffer from angina more often. in fact, overall, angina occurs equally among men and women. microvascular angina, however, occurs more often in women. about 70 percent of the cases of microvascular angina occur in women around the time of menopause. unstable angina occurs more often in older adults. variant angina is rare ; it accounts for only about 2 out of 100 cases of angina. people who have variant angina often are younger than those who have other forms of angina.\n\nyou can prevent and control coronary heart disease ( chd ) by taking action to control your risk factors with heart - healthy lifestyle changes and medicines. examples of risk factors you can control include high blood cholesterol, high blood pressure, and overweight and obesity. only a few risk factorssuch as age, gender, and family historycant be controlled. your risk for chd increases with the number of risk factors you have. to reduce your risk of chd and heart attack, try to control each risk factor you have by adopting the following heart - healthy lifestyles : heart - healthy eating maintaining a healthy weight managing stress physical activity quitting smoking know your family history of health problems related to chd. if you or someone in your family has chd, be sure to tell your doctor. if lifestyle changes aren ' t enough, you also may need medicines to control your chd risk factors.",
  "question": "Who is at risk for Coronary Heart Disease Risk Factors? ?",
  "answers": {
    "text": [
      "High Blood Cholesterol and Triglyceride Levels\n                \nCholesterol\n                \nHigh blood cholesterol is a condition in which your blood has too much cholesterola waxy, fat-like substance. The higher your blood cholesterol level, the greater your risk of coronary heart disease (CHD) and heart attack.\n                \nCholesterol travels through the bloodstream in small packages called lipoproteins. Two major kinds of lipoproteins carry cholesterol throughout your body:\n                \nLow-density lipoproteins (LDL). LDL cholesterol sometimes is called \"bad\" cholesterol. This is because it carries cholesterol to tissues, including your heart arteries. A high LDL cholesterol level raises your risk of CHD.\n                \nHigh-density lipoproteins (HDL). HDL cholesterol sometimes is called \"good\" cholesterol. This is because it helps remove cholesterol from your arteries. A low HDL cholesterol level raises your risk of CHD.\n                \nMany factors affect your cholesterol levels. For example, after menopause, women's LDL cholesterol levels tend to rise, and their HDL cholesterol levels tend to fall. Other factorssuch as age, gender, diet, and physical activityalso affect your cholesterol levels.\n                \nHealthy levels of both LDL and HDL cholesterol will prevent plaque from building up in your arteries. Routine blood tests can show whether your blood cholesterol levels are healthy. Talk with your doctor about having your cholesterol tested and what the results mean.\n                \nChildren also can have unhealthy cholesterol levels, especially if they're overweight or their parents have high blood cholesterol. Talk with your child's doctor about testing your child' cholesterol levels.\n                \nTo learn more about high blood cholesterol and how to manage the condition, go to the Health Topics High Blood Cholesterol article.\n                \nTriglycerides\n                \nTriglycerides are a type of fat found in the blood. Some studies suggest that a high level of triglycerides in the blood may raise the risk of CHD, especially in women.\n                \nHigh Blood Pressure\n                \n\"Blood pressure\" is the force of blood pushing against the walls of your arteries as your heart pumps blood. If this pressure rises and stays high over time, it can damage your heart and lead to plaque buildup.All levels above 120/80 mmHg raise your risk of CHD. This risk grows as blood pressure levels rise. Only one of the two blood pressure numbers has to be above normal to put you at greater risk of CHD and heart attack.\n                \n\n                \nMost adults should have their blood pressure checked at least once a year. If you have high blood pressure, you'll likely need to be checked more often. Talk with your doctor about how often you should have your blood pressure checked.\n                \nChildren also can develop high blood pressure, especially if they're overweight. Your child's doctor should check your child's blood pressure at each routine checkup.\n                \nBoth children and adults are more likely to develop high blood pressure if they're overweight or have diabetes.\n                \nFor more information about high blood pressure and how to manage the condition, go to the Health Topics High Blood Pressure article.\n                \nDiabetes and Prediabetes\n                \nDiabetes is a disease in which the body's blood sugar level is too high. The two types of diabetes are type 1 and type 2.\n                \nIn type 1 diabetes, the body's blood sugar level is high because the body doesn't make enough insulin. Insulin is a hormone that helps move blood sugar into cells, where it's used for energy. In type 2 diabetes, the body's blood sugar level is high mainly because the body doesn't use its insulin properly.\n                \nOver time, a high blood sugar level can lead to increased plaque buildup in your arteries. Having diabetes doubles your risk of CHD.\n                \nPrediabetes is a condition in which your blood sugar level is higher than normal, but not as high as it is in diabetes. If you have prediabetes and don't take steps to manage it, you'll likely develop type 2 diabetes within 10 years. You're also at higher risk of CHD.\n                \nBeing overweight or obese raises your risk of type 2 diabetes. With modest weight loss and moderate physical activity, people who have prediabetes may be able to delay or prevent type 2 diabetes. They also may be able to lower their risk of CHD and heart attack. Weight loss and physical activity also can help control diabetes.\n                \nEven children can develop type 2 diabetes. Most children who have type 2 diabetes are overweight.\n                \nType 2 diabetes develops over time and sometimes has no symptoms. Go to your doctor or local clinic to have your blood sugar levels tested regularly to check for diabetes and prediabetes.\n                \nFor more information about diabetes and heart disease, go to the Health Topics Diabetic Heart Disease article. For more information about diabetes and prediabetes, go to the National Institute of Diabetes and Digestive and Kidney Diseases' (NIDDK's) Introduction to Diabetes.\n                \nOverweight and Obesity\n                \nThe terms \"overweight\" and \"obesity\" refer to body weight that's greater than what is considered healthy for a certain height. More than two-thirds of American adults are overweight, and almost one-third of these adults are obese.\n                \nThe most useful measure of overweight and obesity is body mass index (BMI).You can use the National Heart, Lung, and Blood Institute's (NHLBI's) online BMI calculator to figure out your BMI, or your doctor can help you.\n                \nOverweight is defined differently for children and teens than it is for adults. Children are still growing, and boys and girls mature at different rates. Thus, BMIs for children and teens compare their heights and weights against growth charts that take age and gender into account. This is called BMI-for-age percentile.\n                \nBeing overweight or obese can raise your risk of CHD and heart attack. This is mainly because overweight and obesity are linked to other CHD risk factors, such as high blood cholesterol and triglyceride levels, high blood pressure, and diabetes.\n                \nFor more information, go to the Health Topics Overweight and Obesity article.\n                \nSmoking\n                \nSmoking tobacco or long-term exposure to secondhand smoke raises your risk of CHD and heart attack.\n                \nSmoking triggers a buildup of plaque in your arteries. Smoking also increases the risk of blood clots forming in your arteries. Blood clots can block plaque-narrowed arteries and cause a heart attack.Some research shows that smoking raises your risk of CHD in part by lowering HDL cholesterol levels.\n                \nThe more you smoke, the greater your risk of heart attack. The benefits of quitting smoking occur no matter how long or how much you've smoked. Heart disease risk associated with smoking begins to decrease soon after you quit, and for many people it continues to decrease over time.\n                \nMost people who smoke start when they're teens. Parents can help prevent their children from smoking by not smoking themselves. Talk with your child about the health dangers of smoking and ways to overcome peer pressure to smoke.\n                \nFor more information, including tips on how to quit smoking, go to the Health Topics Smoking and Your Heart article and the NHLBI's \"Your Guide to a Healthy Heart.\"\n                \nFor more information about children and smoking, go to the U.S. Department of Health and Human Services' (HHS') Kids and Smoking Web page and the CDC's Smoking and Tobacco Use Web page.\n                \nLack of Physical Activity\n                \nInactive people are nearly twice as likely to develop CHD as those who are active. A lack of physical activity can worsen other CHD risk factors, such as high blood cholesterol and triglyceride levels, high blood pressure, diabetes and prediabetes, and overweight and obesity.\n                \nIt's important for children and adults to make physical activity part of their daily routines. One reason many Americans aren't active enough is because of hours spent in front of TVs and computers doing work, schoolwork, and leisure activities.\n                \nSome experts advise that children and teens should reduce screen time because it limits time for physical activity. They recommend that children aged 2 and older should spend no more than 2 hours a day watching TV or using a computer (except for school work).\n                \nBeing physically active is one of the most important things you can do to keep your heart healthy. The good news is that even modest amounts of physical activity are good for your health. The more active you are, the more you will benefit.\n                \nFor more information, go to HHS' \"2008 Physical Activity Guidelines for Americans,\" the Health Topics Physical Activity and Your Heart article, and the NHLBI's \"Your Guide to Physical Activity and Your Heart.\"\n                \nUnhealthy Diet\n                \nAn unhealthy diet can raise your risk of CHD. For example, foods that are high in saturated and trans fats and cholesterol raise LDL cholesterol. Thus, you should try to limit these foods.\n                \nIt's also important to limit foods that are high in sodium (salt) and added sugars. A high-salt diet can raise your risk of high blood pressure.\n                \nAdded sugars will give you extra calories without nutrients like vitamins and minerals. This can cause you to gain weight, which raises your risk of CHD. Added sugars are found in many desserts, canned fruits packed in syrup, fruit drinks, and nondiet sodas.\n                \nStress\n                \nStress and anxiety may play a role in causing CHD. Stress and anxiety also can trigger your arteries to tighten. This can raise your blood pressure and your risk of heart attack.\n                \nThe most commonly reported trigger for a heart attack is an emotionally upsetting event, especially one involving anger. Stress also may indirectly raise your risk of CHD if it makes you more likely to smoke or overeat foods high in fat and sugar.\n                \nAge\n                \nIn men, the risk for coronary heart disease (CHD) increases starting around age 45. In women, the risk for CHD increases starting around age 55. Most people have some plaque buildup in their heart arteries by the time theyre in their 70s. However, only about 25 percent of those people have chest pain, heart attacks, or other signs of CHD.\n                \nGender\n                \nSome risk factors may affect CHD risk differently in women than in men. For example, estrogen provides women some protection against CHD, whereas diabetes raises the risk of CHD more in women than in men.\n                \nAlso, some risk factors for heart disease only affect women, such as preeclampsia, a condition that can develop during pregnancy. Preeclampsia is linked to an increased lifetime risk of heart disease, including CHD, heart attack, heart failure, and high blood pressure. (Likewise, having heart disease risk factors, such as diabetes or obesity, increases a womans risk of preeclampsia.)\n                \nFamily History\n                \nA family history of early CHD is a risk factor for developing CHD, specifically if a father or brother is diagnosed before age 55, or a mother or sister is diagnosed before age 65."
    ],
    "answer_start": [
      1848
    ]
  }
}

--- Saving Datasets ---
Training dataset saved to 'c:\Projects\factored-medical-qa-bot\data\run_4\squad_train_data.json'
Validation dataset saved to 'c:\Projects\factored-medical-qa-bot\data\run_4\squad_val_data.json'
Test dataset saved to 'c:\Projects\factored-medical-qa-bot\data\run_4\squad_test_data.json'

--- Summary ---
Training examples: 11480
Validation examples: 2460
Test examples: 2461
Total examples: 16401
==================================================================================================== 
TRAINING MODEL
====================================================================================================
Loading components...
Loading train/validation/test datasets...
Dataset sizes:
  Training: 11480 examples
  Validation: 2460 examples
  Test: 2461 examples
Preprocessing data for model format...
Preprocessed dataset sizes:
  Train: 30270 examples
  Validation: 6536 examples
  Test: 6344 examples
Setting up training arguments...
Using device: cuda
GPU: NVIDIA GeForce RTX 3050 Ti Laptop GPU
GPU Memory: 4.0 GB

--- STARTING TRAINING ---
{'loss': 2.2514, 'grad_norm': 9.42025089263916, 'learning_rate': 9.200000000000002e-06, 'epoch': 0.03}
{'loss': 1.1883, 'grad_norm': 12.51717472076416, 'learning_rate': 1.9200000000000003e-05, 'epoch': 0.05}
{'loss': 0.9008, 'grad_norm': 13.81592845916748, 'learning_rate': 1.983500717360115e-05, 'epoch': 0.08}
{'loss': 0.7994, 'grad_norm': 12.663203239440918, 'learning_rate': 1.9655667144906746e-05, 'epoch': 0.11}
{'loss': 0.6776, 'grad_norm': 12.601893424987793, 'learning_rate': 1.947632711621234e-05, 'epoch': 0.13}
{'loss': 0.5116, 'grad_norm': 6.186931133270264, 'learning_rate': 1.9296987087517934e-05, 'epoch': 0.16}
{'loss': 0.4831, 'grad_norm': 8.025777816772461, 'learning_rate': 1.911764705882353e-05, 'epoch': 0.18}
{'loss': 0.4183, 'grad_norm': 12.661585807800293, 'learning_rate': 1.8938307030129125e-05, 'epoch': 0.21}
{'loss': 0.4784, 'grad_norm': 9.864157676696777, 'learning_rate': 1.8758967001434722e-05, 'epoch': 0.24}
{'loss': 0.3661, 'grad_norm': 7.963259696960449, 'learning_rate': 1.8579626972740316e-05, 'epoch': 0.26}
{'loss': 0.3022, 'grad_norm': 8.343799591064453, 'learning_rate': 1.8400286944045913e-05, 'epoch': 0.29}
{'loss': 0.3102, 'grad_norm': 2.1435234546661377, 'learning_rate': 1.8220946915351507e-05, 'epoch': 0.32}
{'loss': 0.2595, 'grad_norm': 9.4401216506958, 'learning_rate': 1.8041606886657104e-05, 'epoch': 0.34}
{'loss': 0.2508, 'grad_norm': 5.030309677124023, 'learning_rate': 1.7862266857962698e-05, 'epoch': 0.37}
{'loss': 0.2703, 'grad_norm': 9.688754081726074, 'learning_rate': 1.7682926829268296e-05, 'epoch': 0.4}
{'loss': 0.327, 'grad_norm': 15.968904495239258, 'learning_rate': 1.750358680057389e-05, 'epoch': 0.42}
{'loss': 0.281, 'grad_norm': 6.939012050628662, 'learning_rate': 1.7324246771879483e-05, 'epoch': 0.45}
{'loss': 0.2172, 'grad_norm': 5.721532344818115, 'learning_rate': 1.714490674318508e-05, 'epoch': 0.48}
{'loss': 0.1818, 'grad_norm': 12.809946060180664, 'learning_rate': 1.6965566714490674e-05, 'epoch': 0.5}
{'loss': 0.2427, 'grad_norm': 18.271564483642578, 'learning_rate': 1.678622668579627e-05, 'epoch': 0.53}
{'loss': 0.2112, 'grad_norm': 12.452723503112793, 'learning_rate': 1.6606886657101865e-05, 'epoch': 0.55}
{'loss': 0.271, 'grad_norm': 16.077009201049805, 'learning_rate': 1.6427546628407463e-05, 'epoch': 0.58}
{'loss': 0.2078, 'grad_norm': 14.475518226623535, 'learning_rate': 1.6248206599713057e-05, 'epoch': 0.61}
{'loss': 0.2144, 'grad_norm': 0.35796964168548584, 'learning_rate': 1.6068866571018654e-05, 'epoch': 0.63}
{'loss': 0.2474, 'grad_norm': 8.142045021057129, 'learning_rate': 1.5889526542324248e-05, 'epoch': 0.66}
{'loss': 0.2219, 'grad_norm': 19.37856674194336, 'learning_rate': 1.5710186513629845e-05, 'epoch': 0.69}
{'loss': 0.2702, 'grad_norm': 2.1139719486236572, 'learning_rate': 1.553084648493544e-05, 'epoch': 0.71}
{'loss': 0.1673, 'grad_norm': 8.435781478881836, 'learning_rate': 1.5351506456241036e-05, 'epoch': 0.74}
{'loss': 0.1874, 'grad_norm': 1.0938351154327393, 'learning_rate': 1.5172166427546631e-05, 'epoch': 0.77}
{'loss': 0.1745, 'grad_norm': 12.250404357910156, 'learning_rate': 1.4992826398852225e-05, 'epoch': 0.79}
{'loss': 0.1984, 'grad_norm': 4.645456314086914, 'learning_rate': 1.4813486370157821e-05, 'epoch': 0.82}
{'loss': 0.1747, 'grad_norm': 11.329625129699707, 'learning_rate': 1.4634146341463415e-05, 'epoch': 0.85}
{'loss': 0.1731, 'grad_norm': 19.8507137298584, 'learning_rate': 1.4454806312769012e-05, 'epoch': 0.87}
{'loss': 0.1835, 'grad_norm': 12.941428184509277, 'learning_rate': 1.4275466284074606e-05, 'epoch': 0.9}
{'loss': 0.1634, 'grad_norm': 6.754684925079346, 'learning_rate': 1.4096126255380203e-05, 'epoch': 0.92}
{'loss': 0.1475, 'grad_norm': 0.553439199924469, 'learning_rate': 1.3916786226685797e-05, 'epoch': 0.95}
{'loss': 0.134, 'grad_norm': 0.3263716399669647, 'learning_rate': 1.3737446197991392e-05, 'epoch': 0.98}
{'eval_loss': 0.15609581768512726, 'eval_runtime': 81.9734, 'eval_samples_per_second': 79.733, 'eval_steps_per_second': 9.967, 'epoch': 1.0}
{'loss': 0.1342, 'grad_norm': 27.230491638183594, 'learning_rate': 1.3558106169296988e-05, 'epoch': 1.0}
{'loss': 0.121, 'grad_norm': 1.346017837524414, 'learning_rate': 1.3378766140602584e-05, 'epoch': 1.03}
{'loss': 0.1297, 'grad_norm': 20.2181453704834, 'learning_rate': 1.3199426111908177e-05, 'epoch': 1.06}
{'loss': 0.1096, 'grad_norm': inf, 'learning_rate': 1.3020086083213775e-05, 'epoch': 1.08}
{'loss': 0.1583, 'grad_norm': 18.756351470947266, 'learning_rate': 1.2844332855093258e-05, 'epoch': 1.11}
{'loss': 0.0979, 'grad_norm': 22.535999298095703, 'learning_rate': 1.2664992826398855e-05, 'epoch': 1.14}
{'loss': 0.1656, 'grad_norm': 15.341389656066895, 'learning_rate': 1.2489239598278338e-05, 'epoch': 1.16}
{'loss': 0.0952, 'grad_norm': 13.196630477905273, 'learning_rate': 1.2309899569583932e-05, 'epoch': 1.19}
{'loss': 0.0956, 'grad_norm': 1.426902174949646, 'learning_rate': 1.2130559540889527e-05, 'epoch': 1.22}
{'loss': 0.1203, 'grad_norm': 11.6671724319458, 'learning_rate': 1.1951219512195123e-05, 'epoch': 1.24}
{'loss': 0.1193, 'grad_norm': 7.647590160369873, 'learning_rate': 1.1771879483500719e-05, 'epoch': 1.27}
{'loss': 0.0818, 'grad_norm': 30.116069793701172, 'learning_rate': 1.1592539454806312e-05, 'epoch': 1.29}
{'loss': 0.12, 'grad_norm': 0.5150304436683655, 'learning_rate': 1.141319942611191e-05, 'epoch': 1.32}
{'loss': 0.0821, 'grad_norm': 9.42829418182373, 'learning_rate': 1.1233859397417504e-05, 'epoch': 1.35}
{'loss': 0.1415, 'grad_norm': 24.89546775817871, 'learning_rate': 1.10545193687231e-05, 'epoch': 1.37}
{'loss': 0.1179, 'grad_norm': 6.875759601593018, 'learning_rate': 1.0875179340028695e-05, 'epoch': 1.4}
{'loss': 0.172, 'grad_norm': 15.128166198730469, 'learning_rate': 1.069583931133429e-05, 'epoch': 1.43}
{'loss': 0.1162, 'grad_norm': 11.174999237060547, 'learning_rate': 1.0516499282639887e-05, 'epoch': 1.45}
{'loss': 0.1078, 'grad_norm': 1.763338327407837, 'learning_rate': 1.0337159253945481e-05, 'epoch': 1.48}
{'loss': 0.076, 'grad_norm': 1.5149257183074951, 'learning_rate': 1.0157819225251078e-05, 'epoch': 1.51}
{'loss': 0.1396, 'grad_norm': 17.230073928833008, 'learning_rate': 9.978479196556672e-06, 'epoch': 1.53}
{'loss': 0.1222, 'grad_norm': 22.581506729125977, 'learning_rate': 9.799139167862268e-06, 'epoch': 1.56}
{'loss': 0.1096, 'grad_norm': 5.247299671173096, 'learning_rate': 9.619799139167863e-06, 'epoch': 1.59}
{'loss': 0.1116, 'grad_norm': 0.035074274986982346, 'learning_rate': 9.440459110473459e-06, 'epoch': 1.61}
{'loss': 0.0906, 'grad_norm': 0.05285001918673515, 'learning_rate': 9.261119081779055e-06, 'epoch': 1.64}
{'loss': 0.0842, 'grad_norm': 0.3768117427825928, 'learning_rate': 9.08177905308465e-06, 'epoch': 1.66}
{'loss': 0.1364, 'grad_norm': 7.856951713562012, 'learning_rate': 8.902439024390244e-06, 'epoch': 1.69}
{'loss': 0.0966, 'grad_norm': 0.22277309000492096, 'learning_rate': 8.72309899569584e-06, 'epoch': 1.72}
{'loss': 0.0972, 'grad_norm': 3.4264512062072754, 'learning_rate': 8.543758967001435e-06, 'epoch': 1.74}
{'loss': 0.1229, 'grad_norm': 1.5756826400756836, 'learning_rate': 8.36441893830703e-06, 'epoch': 1.77}
{'loss': 0.1051, 'grad_norm': 4.6519622802734375, 'learning_rate': 8.185078909612626e-06, 'epoch': 1.8}
{'loss': 0.0662, 'grad_norm': 0.7522293329238892, 'learning_rate': 8.005738880918222e-06, 'epoch': 1.82}
{'loss': 0.0746, 'grad_norm': 0.147491455078125, 'learning_rate': 7.826398852223817e-06, 'epoch': 1.85}
{'loss': 0.1081, 'grad_norm': 45.38380813598633, 'learning_rate': 7.647058823529411e-06, 'epoch': 1.88}
{'loss': 0.0983, 'grad_norm': 13.676748275756836, 'learning_rate': 7.467718794835008e-06, 'epoch': 1.9}
{'loss': 0.1105, 'grad_norm': 0.019682368263602257, 'learning_rate': 7.288378766140604e-06, 'epoch': 1.93}
{'loss': 0.0905, 'grad_norm': 0.017566055059432983, 'learning_rate': 7.109038737446199e-06, 'epoch': 1.96}
{'loss': 0.0807, 'grad_norm': 1.3619107007980347, 'learning_rate': 6.929698708751794e-06, 'epoch': 1.98}
{'eval_loss': 0.10600000619888306, 'eval_runtime': 52.261, 'eval_samples_per_second': 125.064, 'eval_steps_per_second': 15.633, 'epoch': 2.0}
{'loss': 0.088, 'grad_norm': 4.295504570007324, 'learning_rate': 6.75035868005739e-06, 'epoch': 2.01}
{'loss': 0.0565, 'grad_norm': 1.1452361345291138, 'learning_rate': 6.571018651362984e-06, 'epoch': 2.03}
{'loss': 0.0397, 'grad_norm': 14.016654968261719, 'learning_rate': 6.39167862266858e-06, 'epoch': 2.06}
{'loss': 0.0715, 'grad_norm': 15.829440116882324, 'learning_rate': 6.2123385939741755e-06, 'epoch': 2.09}
{'loss': 0.0655, 'grad_norm': 0.02936146967113018, 'learning_rate': 6.032998565279771e-06, 'epoch': 2.11}
{'loss': 0.0792, 'grad_norm': 34.557228088378906, 'learning_rate': 5.853658536585366e-06, 'epoch': 2.14}
{'loss': 0.0501, 'grad_norm': 0.08811867237091064, 'learning_rate': 5.674318507890961e-06, 'epoch': 2.17}
{'loss': 0.0441, 'grad_norm': 0.016628656536340714, 'learning_rate': 5.494978479196557e-06, 'epoch': 2.19}
{'loss': 0.05, 'grad_norm': 0.038887590169906616, 'learning_rate': 5.315638450502153e-06, 'epoch': 2.22}
{'loss': 0.0636, 'grad_norm': 0.029482748359441757, 'learning_rate': 5.136298421807748e-06, 'epoch': 2.25}
{'loss': 0.0658, 'grad_norm': 8.674447059631348, 'learning_rate': 4.956958393113343e-06, 'epoch': 2.27}
{'loss': 0.0545, 'grad_norm': 0.2388455718755722, 'learning_rate': 4.781205164992827e-06, 'epoch': 2.3}
{'loss': 0.0463, 'grad_norm': 0.20549698173999786, 'learning_rate': 4.601865136298422e-06, 'epoch': 2.33}
{'loss': 0.092, 'grad_norm': 4.780233383178711, 'learning_rate': 4.422525107604018e-06, 'epoch': 2.35}
{'loss': 0.1116, 'grad_norm': 24.484128952026367, 'learning_rate': 4.243185078909613e-06, 'epoch': 2.38}
{'loss': 0.0816, 'grad_norm': 22.02936363220215, 'learning_rate': 4.063845050215208e-06, 'epoch': 2.4}
{'loss': 0.0413, 'grad_norm': 5.842757701873779, 'learning_rate': 3.8845050215208034e-06, 'epoch': 2.43}
{'loss': 0.0573, 'grad_norm': 9.237607955932617, 'learning_rate': 3.7051649928263994e-06, 'epoch': 2.46}
{'loss': 0.0514, 'grad_norm': 28.447141647338867, 'learning_rate': 3.5258249641319945e-06, 'epoch': 2.48}
{'loss': 0.0482, 'grad_norm': 22.237590789794922, 'learning_rate': 3.34648493543759e-06, 'epoch': 2.51}
{'loss': 0.0811, 'grad_norm': 3.9871537685394287, 'learning_rate': 3.167144906743185e-06, 'epoch': 2.54}
{'loss': 0.0581, 'grad_norm': 19.447500228881836, 'learning_rate': 2.9878048780487808e-06, 'epoch': 2.56}
{'loss': 0.0556, 'grad_norm': 21.985424041748047, 'learning_rate': 2.808464849354376e-06, 'epoch': 2.59}
{'loss': 0.0911, 'grad_norm': 57.1997184753418, 'learning_rate': 2.629124820659972e-06, 'epoch': 2.62}
{'loss': 0.0766, 'grad_norm': 2.593236207962036, 'learning_rate': 2.449784791965567e-06, 'epoch': 2.64}
{'loss': 0.0515, 'grad_norm': 13.392068862915039, 'learning_rate': 2.2704447632711625e-06, 'epoch': 2.67}
{'loss': 0.0482, 'grad_norm': 0.06845036894083023, 'learning_rate': 2.0911047345767576e-06, 'epoch': 2.7}
{'loss': 0.0464, 'grad_norm': 14.500574111938477, 'learning_rate': 1.9117647058823528e-06, 'epoch': 2.72}
{'loss': 0.0681, 'grad_norm': 0.1523796170949936, 'learning_rate': 1.7324246771879485e-06, 'epoch': 2.75}
{'loss': 0.0562, 'grad_norm': 0.02841363660991192, 'learning_rate': 1.5530846484935439e-06, 'epoch': 2.77}
{'loss': 0.0379, 'grad_norm': 10.124852180480957, 'learning_rate': 1.3737446197991392e-06, 'epoch': 2.8}
{'loss': 0.034, 'grad_norm': 0.24710583686828613, 'learning_rate': 1.1944045911047348e-06, 'epoch': 2.83}
{'loss': 0.0462, 'grad_norm': 0.09561391174793243, 'learning_rate': 1.01506456241033e-06, 'epoch': 2.85}
{'loss': 0.0344, 'grad_norm': 0.006381443236023188, 'learning_rate': 8.357245337159254e-07, 'epoch': 2.88}
{'loss': 0.0448, 'grad_norm': 16.02311134338379, 'learning_rate': 6.563845050215209e-07, 'epoch': 2.91}
{'loss': 0.0677, 'grad_norm': 4.553374290466309, 'learning_rate': 4.770444763271163e-07, 'epoch': 2.93}
{'loss': 0.0512, 'grad_norm': 10.938490867614746, 'learning_rate': 2.9770444763271165e-07, 'epoch': 2.96}
{'loss': 0.0471, 'grad_norm': 0.09187000244855881, 'learning_rate': 1.1836441893830704e-07, 'epoch': 2.99}
{'eval_loss': 0.10596323013305664, 'eval_runtime': 53.7255, 'eval_samples_per_second': 121.655, 'eval_steps_per_second': 15.207, 'epoch': 3.0}
{'train_runtime': 2827.3648, 'train_samples_per_second': 32.118, 'train_steps_per_second': 2.008, 'train_loss': 0.18102533509396934, 'epoch': 3.0}
--- TRAINING COMPLETED ---

--- EVALUATING ON TEST SET ---
Test Results:
  eval_loss: 0.1019
  eval_runtime: 52.0876
  eval_samples_per_second: 121.7950
  eval_steps_per_second: 15.2240
  epoch: 3.0000

Saving the final model to 'c:\Projects\factored-medical-qa-bot\models\run_4\final_model'...
Model saved successfully!
Training summary saved to 'c:\Projects\factored-medical-qa-bot\models\run_4\training_summary.json'
Training log saved to 'c:\Projects\factored-medical-qa-bot\results\run_4\training_20250725_135300.md'
==================================================================================================== 
EVALUATING MODEL
====================================================================================================
Starting evaluation for run_4
Run description: Revising SQuAD training data generation
Max examples per dataset: 10
Loading components...
Evaluating train dataset...
Evaluating val dataset...
Evaluating test dataset...
Evaluation complete. Report saved to: c:\Projects\factored-medical-qa-bot\reports\run_4\evaluation_20250725_144114.md
